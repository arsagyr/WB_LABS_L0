# WB_LABS_L0 
Проект службы заказов с простейшим web-интерфейсом, отображающий данные о заказе, йоу! Служба получает данные через брокер сообщений nats, соханяет в базе данных и предоставляет их через web-интерфейс.
Разработано нашим вертолётчеством в рамках курса LABS в НГУЭУЭУЭУЭУЭУ.

# Подготовка
Подготовьте свой бубен, наряд и палку, очистите свой разум, надентье снаряжение и начинайте ритмично бить в бубен палкой, постепенно ускоряясь и выговаривая "sudo", "wget", "mv" и "rm". Мы начинаем...

# Подготовка к установке
Установите заранее:

* компилятор Go;
* СУБД PostgreSQL;
* сервер nats.

# Установка
Просто скопируйте репозиторий с github-а:
```bash
git clone https://github.com/arsagyr/WB_LABS_L0.git
```

# Подготовка к запуску

Перед запуском системы надобно сначала создать базу данных службы. Для этого на 20 сточке файла *backend/cmd/main.go* задайте пользователя, пароль и название базы данных (БД) заказов (по умолчанию *"user=postgres password=password dbname=orders sslmode=disable"*). В СУБД PostgreSQL создайте базу данных **"orders"** (или выберите другое название при наличии тезки БД во избежание конфликта). Переключитесь на созданную базу данных и создайте таблицы с помощью файла SQL:
```SQL
\c orders
\i sql/init.sql
```
При желании, можете добавить в БД пример заказа и связанных с ним данных:
```SQL
\i sql/insertmodel.sql
```
Далее запустите сервер **nats**. Внимание, согласно заданию, данные будут передаваться через канал ***"nats-streaming"***.

# Запуск
В папке WB_LABS_L0 выполните следующие команды:
```bash
go mod tidy
go run backend/cmd/main.go
```
Чтобы посмотреть работу службы, перейдите по локальной ссылке [http:///localhost:8181](https://localhost:8181/). Здесь будет представлено маленькое меню по отображению всех записанных данных. Система также записывает данные в кеш. Кеш-файлы находятся в папке *cache*

# Нутра

1) PostgreSQL
    i)  БД - orders
    ii) Ппользователь - postgres
    iii) Таблицы - orders, items, deliveries, payments
2) Служба
    i) Предварительно запустить сервер nats и подключиться к каналу nats-streaming
    ii) Полученные данные в БД orders
    iii) Кэшированны данные сохраняются в папке ***cache***
    iv) В случае падения сервиса необходимо переписать *restartServer()* вместо *runServer()* в файле **backend/cmd/main.go**
    v) Запуск http-сервера происходит по команде *go run backend/cmd/main.go*
3) Разработать простейший интерфейс отображения полученных данных по id заказа
    Интерфейс представлен на сайте ***"http:///localhost:8181/*"**